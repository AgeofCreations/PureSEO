Sub FullCAT()

Dim i As Integer
Dim e As Integer
Dim val As Variant
Dim valu As Variant
Dim PosStr As Long
i = 1
e = 1
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets("Output").Select
    Range("E2").Select 'Auae?aai E2
    PosStr = Cells(1, 1).End(xlDown).Row
    For i = 1 To PosStr
        val = ActiveCell.Value 
        ActiveCell.Offset(1, 0).Select 
        valu = ActiveCell.Value 
    If val = valu Then 
    ActiveCell.Offset(-1, -1).Select 
     Selection.Copy 'Eiie?oai
     ActiveSheet.Next.Select 
     Range("A1").Select
      For d = 1 To 1000
        If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For
        d = d + 1
    Next d
     ActiveSheet.Paste
     ActiveSheet.Previous.Select
     ActiveCell.Offset(1, 1).Select
    ElseIf ActiveCell.Value < 2 Or val < 2 Then Exit For
    Else:
    ActiveSheet.Next.Select
    Application.Run "'PLS WORK.xlsx'!FNForFull"
    ActiveSheet.Previous.Select
    val = ActiveCell.Value
    End If
    Next i ' Iiaoi?yai
    ActiveSheet.Next.Select
    Application.Run "'PLS WORK.xlsx'!FNForFull"
    Sheets("Output").Select
    Application.Run "'PLS WORK.xlsx'!equality"
    Rows("1:1").Select
    Selection.Delete Shift:=xlUp
    Columns("E:E").Select
    Selection.Copy
    ActiveSheet.Next.Select
    Columns("G:G").Select
    ActiveSheet.Paste
    Columns("G:H").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets.Add After:=Sheets(Sheets.Count)
    ActiveSheet.Paste
    Application.Run "'PLS WORK.xlsx'!CATForFull"
    ActiveSheet.Previous.Select
    ActiveWindow.SelectedSheets.Delete
End Sub
Sub FNForFull()

    Dim i As Integer
    Dim replace As Variant
    Dim cell As Range
    Dim r As Range
    Set r = ActiveSheet.UsedRange
    i = 1
    nofFullNames = 1
    d = 1
    Range("A1").Select
    Application.CutCopyMode = False
    ActiveCell.Offset(0, i).Select
    Do Until IsEmpty(Cells(i, 1))
        ActiveCell.FormulaR1C1 = "#"
        ActiveCell.Offset(1, 0).Select
        i = i + 1
    Loop
    ActiveCell.Offset(4 - i, 3).Range("A1").Select
    ActiveCell.FormulaR1C1 = _
        "=CONCATENATE(R[-4]C[-4],R[-4]C[-3],R[-3]C[-4],R[-3]C[-3],R[-2]C[-4],R[-2]C[-3],R[-1]C[-4],R[-1]C[-3],RC[-4],RC[-3],R[1]C[-4],R[1]C[-3],R[2]C[-4],R[2]C[-3],R[3]C[-4],R[3]C[-3],R[4]C[-4],R[4]C[-3],R[5]C[-4],R[5]C[-3],R[6]C[-4],R[6]C[-3],R[7]C[-4],R[7]C[-3],R[8]C[-4],R[8]C[-3],R[9]C[-4],R[9]C[-3],R[10]C[-4],R[10]C[-3])"
    Selection.Copy
    Range("H1").Select
    For nofFullNames = 1 To 1000
    If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For
        nofFullNames = nofFullNames + 1
    Next nofFullNames
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveSheet.Range("A1:B100").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveSheet.Range("E4").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    Range("H1").Select
    For d = 1 To 1000
        If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For
        d = d + 1
    Next d
    Set r = ActiveSheet.UsedRange
    For Each cell In r.Cells
        If Right(cell.Value, 1) = "#" Then
            cell.Value = Left(cell.Value, Len(cell.Value) - 1)
        End If
    Next
End Sub

Sub equality()
Dim i As Integer
Dim e As Integer
Dim val As Variant
Dim valu As Variant
Dim PosStr As Long
PosStr = Cells(1, 1).End(xlDown).Row
i = 1
e = 1
    Range("E2").Select 
    For i = 1 To PosStr
        val = ActiveCell.Value 
        ActiveCell.Offset(1, 0).Select 
        valu = ActiveCell.Value 
    If val = valu Then
    Selection.EntireRow.Delete
    ActiveCell.Offset(-1, 0).Select
    ElseIf ActiveCell.Value < 2 Or val < 2 Then Exit For
    Else: val = ActiveCell.Value
    End If
    Next i ' Iiaoi?yai
End Sub
Sub CATForFull()

    Dim i As Integer
    Dim i2 As Integer
    Dim i3 As Integer
    Dim i4 As Integer
    Dim i5 As Integer
    Dim i6 As Integer
    Dim i7 As Integer
    Dim r As Range
    i = 1
    i2 = 1
    i3 = 1
    i4 = 1
    i5 = 1
    i6 = 1
    i7 = 1
    Columns("B:B").Select
    Selection.Cut
    Range("H1").Select
    ActiveSheet.Paste
    Selection.Copy
    Range("BG1").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Selection.TextToColumns Destination:=Range("BG1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :="#", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, _
        1), Array(6, 1), Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12 _
        , 1)), TrailingMinusNumbers:=True
    Columns("BG:BG").Select
    Selection.Copy
    Range("D1").Select
    ActiveSheet.Paste
    Columns("BG:CW").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "ID"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = ";"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "Const1"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "Title"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "FN"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "Const2"
    Range("G1").Select
    ActiveCell.FormulaR1C1 = ";"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = ";;;;;"
    Range("B1").Select
     Do Until IsEmpty(Cells(i, 1))
     ActiveCell.FormulaR1C1 = ";"
     ActiveCell.Offset(1, 0).Select
     i = i + 1
     Loop
    Range("C2").Select
     Do Until IsEmpty(Cells(i2, 1))
     ActiveCell.FormulaR1C1 = "Купить"
     ActiveCell.Offset(1, 0).Select
     i2 = i2 + 1
     Loop
     ActiveCell.Offset(-1, 0).Select
     Selection.ClearContents
    Range("F2").Select
    ActiveCell.FormulaR1C1 = _
        "— êóïèòü îïòîì è â ðîçíèöó | Öåíà îò ##minPrice## ð â èíòåðíåò ìàãàçèíå Ñèìà-ëåíä"
    Range("G1").Select
     Do Until IsEmpty(Cells(i3, 1))
     ActiveCell.FormulaR1C1 = ";"
     ActiveCell.Offset(1, 0).Select
     i3 = i3 + 1
     Loop
    Range("E2").Select
     Do Until IsEmpty(Cells(i4, 1)) '— êóïèòü îïòîì è â ðîçíèöó | Öåíà îò ##minPrice## ð â èíòåðíåò ìàãàçèíå Ñèìà-ëåíä
     ActiveCell.FormulaR1C1 = " "
     ActiveCell.Offset(1, 0).Select
     i4 = i4 + 1
     Loop
     ' Range("F2").Select
     Do Until IsEmpty(Cells(i6, 1))
     ActiveCell.FormulaR1C1 = "оптом и в розницу | Цена от ##minPrice## р в интернет магазине Сима-ленд"
     ActiveCell.Offset(1, 0).Select
     i6 = i6 + 1
     Loop
     ActiveCell.Offset(-1, 0).Select
     Selection.ClearContents
     Range("A1").Select
     Range("J1").Select
     Do Until IsEmpty(Cells(i7, 1))
     ActiveCell.FormulaR1C1 = ";;;;;"
     ActiveCell.Offset(1, 0).Select
     i7 = i7 + 1
     Loop
End Sub



Sub Sort()

    Columns("D:F").Select
    Selection.AutoFilter
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Add Key:=Range _
        ("F1:F137"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("Output").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Add Key:=Range _
        ("E2:E137"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Add(Range( _
        "E2:E137"), xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color _
        = RGB(253, 173, 246)
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Add(Range( _
        "E2:E137"), xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color _
        = RGB(182, 255, 161)
    With ActiveWorkbook.Worksheets("Output").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub

Sub SFP()
'
' SFP Макрос
'
' Hotkey: Ctrl+n
'
    Dim i As Integer
    Dim i2 As Integer
    Dim i3 As Integer
    Dim i4 As Integer
    Dim i5 As Integer
    Dim r As Range
    i = 1
    i2 = 1
    i3 = 1
    i4 = 1
    i5 = 1
    Columns("B:B").Select
    Selection.Cut
    Range("C1").Select
    ActiveSheet.Paste
    Selection.Copy
    Range("BG1").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Selection.TextToColumns Destination:=Range("BG1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :="#", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, _
        1), Array(6, 1), Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12 _
        , 1)), TrailingMinusNumbers:=True
    Columns("BG:BG").Select
    Selection.Copy
    Range("E1").Select
    ActiveSheet.Paste
    Columns("BG:CW").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "ID"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = ";"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "FN"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = ";"
    Range("E1").Select
    ActiveCell.FormulaR1C1 = "Title"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "Const"
    Range("G1").Select
    ActiveCell.FormulaR1C1 = ";;;;;"
    Range("B1").Select
     Do Until IsEmpty(Cells(i, 1))
     ActiveCell.FormulaR1C1 = ";"
     ActiveCell.Offset(1, 0).Select
     i = i + 1
     Loop
    Range("D1").Select
     Do Until IsEmpty(Cells(i2, 1))
     ActiveCell.FormulaR1C1 = ";"
     ActiveCell.Offset(1, 0).Select
     i2 = i2 + 1
     Loop
    Range("F2").Select
    ActiveCell.FormulaR1C1 = _
        "— купить оптом и в розницу | Цена от ##minPrice## р в интернет магазине Сима-ленд"
    Range("G1").Select
     Do Until IsEmpty(Cells(i3, 1))
     ActiveCell.FormulaR1C1 = ";;;;;"
     ActiveCell.Offset(1, 0).Select
     i3 = i3 + 1
     Loop
    Range("F2").Select
     Do Until IsEmpty(Cells(i4, 1))
     ActiveCell.FormulaR1C1 = "— купить оптом и в розницу | Цена от ##minPrice## р в интернет магазине Сима-ленд"
     ActiveCell.Offset(1, 0).Select
     i4 = i4 + 1
     Loop
     ActiveCell.Offset(-1, 0).Select
     Selection.ClearContents
     Range("E1").Select
     Set r = ActiveCell
     For i5 = 1 To 1000
     If ActiveCell.Value > 2 Then ActiveCell.Value = replace(r, Mid(r, 1, 1), UCase(Mid(r, 1, 1)), 1, 1) Else: Exit For
     ActiveCell.Offset(1, 0).Select
     Set r = ActiveCell
     i5 = i5 + 1
     Next i5
     Range("A1").Select
End Sub
