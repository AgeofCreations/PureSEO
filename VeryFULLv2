Sub FullCAT()
'
' Для быстрых категорий
'

Dim i As Integer
Dim e As Integer
Dim val As Variant
Dim valu As Variant
Dim PosStr As Long
i = 1
e = 1
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets("Output").Select
    Range("E2").Select 'Выбираем ячейку Е2
    PosStr = Cells(1, 1).End(xlDown).Row
    For i = 1 To PosStr
		ActiveCell.Offset(0, -1).Select 'Cмещаемся на ячейку с запросом, содержащуюся слева от первой ячейки ID для текущего цикла.
		Selection.Copy 'Копируем
		ActiveSheet.Next.Select 'Выбираем следующий лист.
		Range("A1").Select 'Выбираем там ячейку А1
			For d = 1 To 1000 'Объявляем цикл для скрипта FN
				If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For 'Проверяем ячейку на заполненность. Если заполнена, смещаемся на следующую. Если нет, выходим из цикла.
				d = d + 1 'Это для повтора цикла
			Next d 'Повторяем цикл
			ActiveSheet.Paste 'Вставляем
			ActiveSheet.Previous.Select 'Выбираем предыдущий лист
			ActiveCell.Offset(0, 1).Select
        val = ActiveCell.Value 'Присваиваем переменной значение ячейки
        ActiveCell.Offset(1, 0).Select 'Смещаемся на 1 вниз
        valu = ActiveCell.Value 'Присваиваем значение следующей ячейки следующей переменной.
		ActiveCell.Offset(1, 0).Select 'Смещаемся с текущей ячейки на ячейку с ID ниже по строке для проверки на заполненность
    If val = valu Then 'Сравниваем их
		ActiveCell.Offset(-1, -1).Select 'Если равны, смещаемся на ячейку с запросом, содержащуюся слева от первой ячейки ID для текущего цикла.
		Selection.Copy 'Копируем
		ActiveSheet.Next.Select 'Выбираем следующий лист.
		'Range("A1").Select 'Выбираем там ячейку А1
		'd=1
		
		'For d = 1 To 1000 'Объявляем цикл для скрипта FN
		'	If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For 'Проверяем ячейку на заполненность. Если заполнена, смещаемся на следующую. Если нет, выходим из цикла.
	'			d = d + 1 'Это для повтора цикла
	'	Next d 'Повторяем цикл
		
    ' ActiveSheet.Paste 'Вставляем
	 'ActiveSheet.Previous.Select 'Выбираем предыдущий лист
     ActiveCell.Offset(0, 1).Select 'Смещаемся с текущей ячейки на ячейку с ID ниже по строке для проверки на запролненность
    ElseIf ActiveCell.Value < 2 and val < 2 Then Exit For ' Если ячейка пуста, выходим из цикла
    Else: ' В противном случае
		ActiveSheet.Next.Select ' Выбираем следующий лист
		Application.Run "'PERSONAL.xlsb'!FNForFull" 'Собираем запросы в Fullname
		ActiveSheet.Previous.Select ' Возвращаемся на первый лист
		ActiveCell.Offset(-1, 0).Select
		val = ActiveCell.Value ' Готовимся к началу работы со следующей группой
    End If ' Закрываем условие
	
    Next i ' Начинаем всё заново со след. Группой
	
		ActiveSheet.Next.Select 'Когда всё заканчивается, в последний раз выбираем следующий лист для данного скрипта (FN)
		Application.Run "'PERSONAL.xlsb'!FNForFull" ' В последний раз используем его для захвата крайней группы.
		Sheets("Output").Select ' Возвращаемся на первый лист
		Application.Run "'PERSONAL.xlsb'!equality" ' Удаляем строки с повторяющимся ID группы.
		Rows("1:1").Select ' Выбираем первую стркоу
		Selection.Delete Shift:=xlUp 'Удаляем заголовки стобцов (первую строку)
		Columns("E:E").Select ' Выбираем стобец с ID
		Selection.Copy ' Копируем
		ActiveSheet.Next.Select' Выбираем следующий лист
		Columns("G:G").Select' Выбиаем колонки
		ActiveSheet.Paste'Вставляем ID
		Columns("G:I").Select' Выделяем ID c фуллнеймами и тайтлами
		Application.CutCopyMode = False' Очищаем буфер
		Selection.Copy' Копируем
		Sheets.Add After:=Sheets(Sheets.Count)' Создаем новый лист
		ActiveSheet.Paste' Вставляем значения туда
		Application.Run "'PERSONAL.xlsb'!CATForFull"' Запускаем скрипт, который превращает все это в форму
		Columns("A:A").Select' Выбираем колонки А
    With Selection.Interior'
        .Pattern = xlNone'
        .TintAndShade = 0'
        .PatternTintAndShade = 0' 
    End With' Всем этим циклом убираем заливку цветом , которая у нас скопировалась с первого листа
    Range("A1").Select' Выбираем А1
    ActiveSheet.Previous.Select' Возвращаемся на лист с уже не нужной инфой
    ActiveWindow.SelectedSheets.Delete' Удаляем к чертовой матери его.
End Sub
Sub FNForFull()
'
' FN
'
' Ni?aoaiea eeaaeo: Ctrl+Shift+A
'
    Dim i As Integer
    Dim replace As Variant
    Dim cell As Range
    Dim r As Range
    Dim PosStr As Long
    Dim RowNumber As Integer
    Set r = ActiveSheet.UsedRange
    i = 1
    nofFullNames = 1
    d = 1
    noTitles = 1
    Range("A1").Select
    Application.CutCopyMode = False
    ActiveCell.Offset(0, i).Select
    Do Until IsEmpty(Cells(i, 1))
        ActiveCell.FormulaR1C1 = "#"
        ActiveCell.Offset(1, 0).Select
        i = i + 1
    Loop
    RowNumber = ActiveSheet.Range("A65536").End(xlUp).Row
    Range("E4").Select
    If RowNumber > 2 Then
    ActiveCell.FormulaR1C1 = _
        "=CONCATENATE(R[-2]C[-4],R[-2]C[-3],R[-1]C[-4],R[-1]C[-3],RC[-4],RC[-3])"
        Else
    ActiveCell.FormulaR1C1 = _
        "=CONCATENATE(R[-4]C[-4],R[-4]C[-3],R[-3]C[-4],R[-3]C[-3],R[-2]C[-4],R[-2]C[-3],R[-1]C[-4],R[-1]C[-3],RC[-4])"
        End If
    Selection.Copy
    Range("H1").Select
    For nofFullNames = 1 To 1000
        If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For
        nofFullNames = nofFullNames + 1
    Next nofFullNames
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("E5").Select
    ActiveCell.FormulaR1C1 = "=CONCATENATE(R[-4]C[-4],R[-4]C[-3])"
    Selection.Copy
    Range("I1").Select
    For noTitles = 1 To 1000
        If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For
        noTitles = noTitles + 1
    Next noTitles
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveSheet.Range("A1:B100").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveSheet.Range("E4").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveSheet.Range("E5").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    Range("H1").Select
    For d = 1 To 1000
        If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For
        d = d + 1
    Next d
    Set r = ActiveSheet.UsedRange
    For Each cell In r.Cells
        If Right(cell.Value, 1) = "#" Then
            cell.Value = Left(cell.Value, Len(cell.Value) - 1)
        End If
    Next
End Sub

Sub equality()
Dim i As Integer
Dim e As Integer
Dim val As Variant
Dim valu As Variant
Dim PosStr As Long
PosStr = Cells(1, 1).End(xlDown).Row
i = 1
e = 1
    Range("E2").Select 'Auae?aai E2
    For i = 1 To PosStr
        val = ActiveCell.Value 'I?enaaeaaai val cia?aiea y?aeee
        ActiveCell.Offset(1, 0).Select 'Auae?aai neaao?uo? y?aeeo
        valu = ActiveCell.Value 'I?enaaeaaai valu cia?aiea y?aeee
    If val = valu Then
    Selection.EntireRow.Delete
    ActiveCell.Offset(-1, 0).Select
    ElseIf ActiveCell.Value < 2 Or val < 2 Then Exit For
    Else: val = ActiveCell.Value
    End If
    Next i ' Iiaoi?yai
End Sub
Sub CATForFull()
'
' SFP Iae?in
'
'
    Dim i As Integer
    Dim i2 As Integer
    Dim i3 As Integer
    Dim i4 As Integer
    Dim i5 As Integer
    Dim i6 As Integer
    Dim i7 As Integer
    Dim r As Range
    i = 1
    i2 = 1
    i3 = 1
    i4 = 1
    i5 = 1
    i6 = 1
    i7 = 1
    Columns("B:B").Select
    Selection.Cut
    Range("H1").Select
    ActiveSheet.Paste
    Columns("C:C").Select
    Selection.Cut
    Range("D1").Select
    ActiveSheet.Paste
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "ID"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = ";"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "Const1"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "Title"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "FN"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "Const2"
    Range("G1").Select
    ActiveCell.FormulaR1C1 = ";"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = ";;;;;"
    Range("B1").Select
     Do Until IsEmpty(Cells(i, 1))
        ActiveCell.FormulaR1C1 = ";"
        ActiveCell.Offset(1, 0).Select
        i = i + 1
     Loop
    Range("C2").Select
     Do Until IsEmpty(Cells(i2, 1))
        ActiveCell.FormulaR1C1 = "Купить"
        ActiveCell.Offset(1, 0).Select
        i2 = i2 + 1
     Loop
     ActiveCell.Offset(-1, 0).Select
     Selection.ClearContents
    Range("F2").Select
    ActiveCell.FormulaR1C1 = _
        "— оптом и в розницу | Цена от ##minPrice## р в интернет-магазине Сима-ленд"
    Range("G1").Select
     Do Until IsEmpty(Cells(i3, 1))
        ActiveCell.FormulaR1C1 = ";"
        ActiveCell.Offset(1, 0).Select
        i3 = i3 + 1
     Loop
    Range("E2").Select
     Do Until IsEmpty(Cells(i4, 1)) '— eoieou iioii e a ?icieoo | Oaia io ##minPrice## ? a eioa?iao iaaaceia Neia-eaia
        ActiveCell.FormulaR1C1 = " "
        ActiveCell.Offset(1, 0).Select
        i4 = i4 + 1
     Loop
     Range("F2").Select
     Do Until IsEmpty(Cells(i6, 1))
        ActiveCell.FormulaR1C1 = "оптом и в розницу | Цена от ##minPrice## р в интернет-магазине Сима-ленд"
        ActiveCell.Offset(1, 0).Select
        i6 = i6 + 1
     Loop
     ActiveCell.Offset(-1, 0).Select
     Selection.ClearContents
     Range("A1").Select
     Range("I1").Select
     Do Until IsEmpty(Cells(i7, 1))
        ActiveCell.FormulaR1C1 = ";;;;;"
        ActiveCell.Offset(1, 0).Select
        i7 = i7 + 1
     Loop
End Sub


Sub FullSFP()

Dim i As Integer
Dim e As Integer
Dim val As Variant
Dim valu As Variant
Dim PosStr As Long
i = 1
e = 1
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets("Output").Select
    Range("E2").Select 'Auae?aai E2
    PosStr = Cells(1, 1).End(xlDown).Row
    For i = 1 To PosStr
        val = ActiveCell.Value
        ActiveCell.Offset(1, 0).Select
        valu = ActiveCell.Value
    If val = valu Then
    ActiveCell.Offset(-1, -1).Select
     Selection.Copy 'Eiie?oai
     ActiveSheet.Next.Select
     Range("A1").Select
      For d = 1 To 1000
        If ActiveCell.Value > 2 Then ActiveCell.Offset(1, 0).Select Else: Exit For
        d = d + 1
    Next d
     ActiveSheet.Paste
     ActiveSheet.Previous.Select
     ActiveCell.Offset(1, 1).Select
    ElseIf ActiveCell.Value < 2 Or val < 2 Then Exit For
    Else:
    ActiveSheet.Next.Select
    Application.Run "'PERSONAL.xlsb'!FNForFull"
    ActiveSheet.Previous.Select
    val = ActiveCell.Value
    End If
    Next i ' Iiaoi?yai
    ActiveSheet.Next.Select
    Application.Run "'PERSONAL.xlsb'!FNForFull"
    Sheets("Output").Select
    Application.Run "'PERSONAL.xlsb'!equality"
    Rows("1:1").Select
    Selection.Delete Shift:=xlUp
    Columns("E:E").Select
    Selection.Copy
    ActiveSheet.Next.Select
    Columns("G:G").Select
    ActiveSheet.Paste
    Columns("G:I").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets.Add After:=Sheets(Sheets.Count)
    ActiveSheet.Paste
    Application.Run "'PERSONAL.xlsb'!SFP"
End Sub
Sub SFP()
'
' SFP ??????
'
' Hotkey: Ctrl+n
'
    Dim i As Integer
    Dim i2 As Integer
    Dim i3 As Integer
    Dim i4 As Integer
    Dim i5 As Integer
    Dim r As Range
    i = 1
    i2 = 1
    i3 = 1
    i4 = 1
    i5 = 1
    Columns("C:C").Select
    Selection.Cut
    Range("E1").Select
    ActiveSheet.Paste
    Columns("B:B").Select
    Selection.Cut
    Range("C1").Select
    ActiveSheet.Paste
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "ID"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = ";"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "FN"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = ";"
    Range("E1").Select
    ActiveCell.FormulaR1C1 = "Title"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "Const"
    Range("G1").Select
    ActiveCell.FormulaR1C1 = ";;;;;"
    Range("B1").Select
     Do Until IsEmpty(Cells(i, 1))
     ActiveCell.FormulaR1C1 = ";"
     ActiveCell.Offset(1, 0).Select
     i = i + 1
     Loop
    Range("D1").Select
     Do Until IsEmpty(Cells(i2, 1))
     ActiveCell.FormulaR1C1 = ";"
     ActiveCell.Offset(1, 0).Select
     i2 = i2 + 1
     Loop
    Range("F2").Select
    ActiveCell.FormulaR1C1 = _
        "— купить оптом и в розницу | Цена от ##minPrice## р в интернет-магазине Сима-ленд"
    Range("G1").Select
     Do Until IsEmpty(Cells(i3, 1))
     ActiveCell.FormulaR1C1 = ";;;;;"
     ActiveCell.Offset(1, 0).Select
     i3 = i3 + 1
     Loop
    Range("F2").Select
     Do Until IsEmpty(Cells(i4, 1))
     ActiveCell.FormulaR1C1 = "— купить оптом и в розницу | Цена от ##minPrice## р в интернет-магазине Сима-ленд"
     ActiveCell.Offset(1, 0).Select
     i4 = i4 + 1
     Loop
     ActiveCell.Offset(-1, 0).Select
     Selection.ClearContents
     Range("E1").Select
     Set r = ActiveCell
     For i5 = 1 To 1000
     If ActiveCell.Value > 2 Then ActiveCell.Value = replace(r, Mid(r, 1, 1), UCase(Mid(r, 1, 1)), 1, 1) Else: Exit For
     ActiveCell.Offset(1, 0).Select
     Set r = ActiveCell
     i5 = i5 + 1
     Next i5
     Range("A1").Select
    ActiveSheet.Previous.Select
    ActiveWindow.SelectedSheets.Delete
       Columns("A:A").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
End Sub


Sub Sort()
'
' Iae?in1 Iae?in
'


    Columns("D:F").Select
    Selection.AutoFilter
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Add Key:=Range _
        ("F1:F137"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("Output").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Add Key:=Range _
        ("E2:E137"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Add(Range( _
        "E2:E137"), xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color _
        = RGB(253, 173, 246)
    ActiveWorkbook.Worksheets("Output").AutoFilter.Sort.SortFields.Add(Range( _
        "E2:E137"), xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color _
        = RGB(182, 255, 161)
    With ActiveWorkbook.Worksheets("Output").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub


